<!DOCTYPE html>
<!-- saved from url=(0067)https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title></title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="./bootstrap.css">
    <!-- Owl Carousel stylesheet -->
    <link rel="stylesheet" href="./owl.css">
   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<link href="./webyclip_002.css" rel="stylesheet" type="text/css"><link href="./webyclip_002.css" rel="stylesheet" type="text/css"><link href="./webyclip.css" rel="stylesheet" type="text/css"><link href="./webyclip_003.css" rel="stylesheet" type="text/css"><link href="./webyclip_003.css" rel="stylesheet" type="text/css"></head>
<body class="player-body">
    <div class="mask embedded">
        <div class="wc-container no-rel-itm embedded no-rel-vid" data-iframe-height="">
            <div id="report_container" class="report-container">
                <div style="display: none;" class="report-close">
                    <a title="Close" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                </div>
                <p id="tell_us_more">Tell us why do you want to report this video:</p>
                <div id="options"><input data-leaf-level="true" data-key="does_not_match_product" data-level="1" value="does_not_match_product" id="opt1" name="reportOpt" type="radio"><label class="opt-label" for="opt1">Video doesn't match product</label><br><input data-leaf-level="true" data-key="inaccurate_or_misleading" data-level="1" value="inaccurate_or_misleading" id="opt2" name="reportOpt" type="radio"><label class="opt-label" for="opt2">Video is inaccurate or misleading</label><br><input data-key="infringes_my_rights" data-level="1" value="infringes_my_rights" id="opt3" name="reportOpt" type="radio"><label class="opt-label" for="opt3">Video infringes my rights:</label><br><div style="display: none;" data-level="2" class="subOptions" id="opt3_suboptions"><input data-leaf-level="true" data-key="trademark_infringement" data-level="2" value="trademark_infringement" id="opt3_1" name="reportOpt2" type="radio"><label class="opt-label" for="opt3_1">Trademark infringement</label><br><input data-key="copyright_infringement" data-level="2" value="copyright_infringement" id="opt3_2" name="reportOpt2" type="radio"><label class="opt-label" for="opt3_2">Copyright infringement:</label><br><div style="display: none;" data-level="3" class="subOptions" id="opt3_2_suboptions"><input data-leaf-level="true" data-key="related_to_music" data-level="3" value="related_to_music" id="opt3_2_1" name="reportOpt3" type="radio"><label class="opt-label" for="opt3_2_1">Related to music</label><br><input data-leaf-level="true" data-key="related_to_visual_content" data-level="3" value="related_to_visual_content" id="opt3_2_2" name="reportOpt3" type="radio"><label class="opt-label" for="opt3_2_2">Related to visual content</label><br><input data-leaf-level="true" data-key="related_to_both_music_and_visual_content" data-level="3" value="related_to_both_music_and_visual_content" id="opt3_2_3" name="reportOpt3" type="radio"><label class="opt-label" for="opt3_2_3">Related to both music/visual content</label><br></div><input data-leaf-level="true" data-key="other_ip_rights" data-level="2" value="other_ip_rights" id="opt3_3" name="reportOpt2" type="radio"><label class="opt-label" for="opt3_3">Other IP rights</label><br></div><input data-leaf-level="true" data-key="poor_quality" data-level="1" value="poor_quality" id="opt4" name="reportOpt" type="radio"><label class="opt-label" for="opt4">Video is of poor quality</label><br><input data-leaf-level="true" data-key="offensive_or_inappropriate" data-level="1" value="offensive_or_inappropriate" id="opt5" name="reportOpt" type="radio"><label class="opt-label" for="opt5">Video is offensive or inappropriate</label><br><input data-leaf-level="true" data-key="other" data-level="1" value="other" id="opt6" name="reportOpt" type="radio"><label class="opt-label" for="opt6">Other</label><br></div>
                <div style="display: none;" id="extraTextInput" class="input-group pull-right">
                    <input class="form-control" placeholder="" type="text">
                </div>
                <div class="form-group" id="comment">
                    <label id="comment-label"></label>
                    <textarea class="form-control" placeholder="Comment"></textarea>
                </div>
                <div class="report-actions">
                    <a href="javascript:void(0)" class="btn btn-cancel" id="btn_cancel">Cancel</a>
                    <a href="javascript:void(0)" class="btn btn-ok" id="btn_submit">Send</a>
                </div>
                <div id="login_to_remove" class="login-to-remove"></div>
            </div>
            <div class="disclaimer-container">This YouTube video has 
been automatically selected by the WebyClip service. The video contains 
an example of the item for sale, which may not be representative of the 
item you are purchasing. Please check the product description and 
condition before purchasing. No recommendation from the video creator is
 implied.</div>
            <div class="top-area"></div>
            <div style="height: 212px;" class="media-area">
                <div class="left">
                    <div class="close-me visibility-never">
                        <a title="Close" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                    </div>
                    <div class="title-container no-compact">
                        <div title="Minecraft Xbox 360 Edition - Chill Modern House [+ Private Beach]" class="media-title visibility-never">Minecraft Xbox 360 Edition - Chill Modern House [+ Private Beach]</div>
                        <div class="media-share visibility-never">
                            <div class="share-button">
                                <div class="share-img">
                                    <a class="link-button"></a>
                                </div>
                            </div>
                        </div>
                        <div class="social-networks-list visibility-never">
                            <div class="facebook">
                                <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div class="googleplus google-plus">
                                <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div class="linkedin">
                                <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div class="twitter">
                                <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div style="display: none;" class="whatsapp">
                                <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div class="pinterest">
                                <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                        </div>
                    </div>
                    <div id="ar_container" class="media-player ar-container">
                        <div class="inner-media-player ar-inner-container">
                            <div class="desktop-more-videos-container visibility-extended">
                                <div class="more-videos-title ">
                                    <span class="more-videos-caption">See more</span>
                                </div>
                                <div style="outline: medium none; overflow: hidden;" tabindex="0" class="desktop-more-videos-list"></div><div style="position: absolute; z-index: 1; margin: 0px; padding: 0px; opacity: 0; display: none; left: 100px; top: 0px;"><div class="enscroll-track scroll-track" style="position: relative;"><a class="scroll-handle" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html" style="position: absolute; z-index: 1;"><div class="top"></div><div class="bottom"></div></a></div></div><div style="position: absolute; z-index: 1; margin: 0px; padding: 0px; opacity: 0; display: none; left: 0px; top: 0px;"><div class="enscroll-track scroll-track" style="position: relative;"><a class="scroll-handle" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html" style="position: absolute; z-index: 1;"><div class="top"></div><div class="bottom"></div></a></div></div>
                            </div>
                            <div class="page-corner visibility-never">
                                <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div style="border-radius: 0px 0px 8px;" class="custom-icon visibility-never">
                                <a style="background: transparent url(&quot;http://pics.ebaystatic.com/aw/pics/icon/iconTrashcan_16x16.gif&quot;) no-repeat scroll center center / contain ; width: 16px; height: 16px;" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                        <iframe style="display: inline;" src="./4gzMVC3ZlOI.html" title="YouTube video player" allowfullscreen="1" class="player" data-type="youtube" data-id="youtube_4gzMVC3ZlOI" data-index="0" id="player-0" frameborder="0" height="100%" width="100%"></iframe><div style="display: none;" class="player" data-type="youtube" data-id="youtube_4gzMVC3ZlOI" data-index="0" id="player-0"></div></div>
                        <div class="related-items-hide-button bt-left visibility-never">
                            <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                        </div>
                    </div>
                    <div class="mobile-actions">
                        <div class="social visibility-never likeOn dislikeOn">
                            <span class="social-caption">Was this helpful?</span>
                            <div class="like">
                                <a title="Yes, this was helpful" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div class="liked">
                                <a title="I regret marking this as helpful" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div class="dislike">
                                <a title="No, this wasn&#39;t helpful" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                            <div class="disliked">
                                <a title="I regret marking this as not helpful" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                        </div>
                        <div title="Report" class="webyclip-report visibility-always">
                            <div class="report">
                                <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                            </div>
                        </div>
                    </div>
                    <div class="related-items-container visibility-compact">
                        <div class="default-related-items">
                            <div class="related-items-title">
                                <div class="related-items-collapse-icon">
                                    <a class="link-button"></a>
                                </div>
                                <span class="related-items-caption">Related Items</span>
                            </div>
                            <div class="carousel-arrows push-left disabled"></div>
                            <div class="related-items-list"></div>
                            <div class="carousel-arrows push-right"></div>
                        </div>
                        <div class="custom-related-items"></div>
                    </div>
                    <div class="more-videos-container visibility-never">
                        <div class="more-videos-title ">
                            <div class="more-videos-collapse-icon">
                                <a class="link-button"></a>
                            </div>
                            <span class="more-videos-caption">See more</span>
                        </div>
                        <div style="opacity: 0;" class="more-videos-list"></div>
                    </div>
                </div>
                <div class="right">
                    <div class="desktop-related-items-container visibility-extended">
                        <div class="default-related-items">
                            <div class="related-items-title">
                                <span class="related-items-caption">Related Items</span>
                            </div>
                            <div class="desktop-related-items-list"></div>
                        </div>
                        <div class="custom-related-items">

                        </div>
                    </div>
                </div>
            </div>
            <div class="webyclip-area">
                <div class="actions">
                    <div class="social visibility-never likeOn dislikeOn">
                        <span class="social-caption">Was this helpful?</span>
                        <div class="like">
                            <a title="Yes, this was helpful" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                        </div>
                        <div class="liked">
                            <a title="I regret marking this as helpful" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                        </div>
                        <div class="dislike">
                            <a title="No, this wasn&#39;t helpful" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                        </div>
                        <div class="disliked">
                            <a title="I regret marking this as not helpful" class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                        </div>
                    </div>
                    <div title="Report" class="webyclip-report visibility-always">
                        <div class="report">
                            <a class="link-button" href="https://mohanpatt.github.io/mtpprp2/index_files/WebyclipPlayer.html#"></a>
                        </div>
                    </div>
                </div>
                <div class="webyclip-credit visibility-never">
                    <span class="credit">Powered by WebyClip</span>
                    <div class="logo">
                        <a target="_blank" class="link-button" href="http://www.webyclip.com/"></a>
                    </div>
                </div>
                <div class="disclaimer-toggle visibility-never">
                    <span class="disclaimer-toggle-caption">Disclaimer</span>
                </div>
                <div class="disclaimer visibility-always">This YouTube 
video has been automatically selected by the WebyClip service. The video
 contains an example of the item for sale, which may not be 
representative of the item you are purchasing. Please check the product 
description and condition before purchasing. No recommendation from the 
video creator is implied.</div>
            </div>
        </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" id="www-widgetapi-script" src="./www-widgetapi.js" async=""></script><script src="./iframe_api" async=""></script><script async="" src="./webyclip_003.js"></script><script async="" src="./webyclip_003.js"></script><script async="" src="./webyclip_002.js"></script><script async="" src="./www-widgetapi(1).js" id="www-widgetapi-script" type="text/javascript"></script><script async="" src="./iframe_api(1)"></script><script src="./jquery.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="./bootstrap.js"></script>
    <!-- owl-carousel js plugin -->
    <script type="text/javascript" src="./owl.js"></script>
    <!-- dotdotdot -->
    <script type="text/javascript" src="./jquery_002.js"></script>
    <!-- enscroll -->
    <script type="text/javascript" src="./enscroll-0.js"></script>
    <!-- WebyClip scripts -->
    <script type="application/javascript" src="./webyclip.js"></script>
    <script type="text/javascript" src="./webyclip_004.js"></script>
    <script type="text/javascript">
    (function($) {

        var ShareWidget = function() {

            var _getOptions = function() {
                var top, left;
                var width = 550;
                var height = 420;
                var winHeight = screen.height;
                var winWidth = screen.width;
                left = Math.round((winWidth / 2) - (width / 2));
                top = 0;
                if (winHeight > height) {
                    top = Math.round((winHeight / 2) - (height / 2));
                }
                return 'scrollbars=yes,resizable=yes,toolbar=no,location=yes' + ',width=' + width +
                        ',height=' + height + ',left=' + left + ',top=' + top
            };

            var _openWindow = function(url) {
                var win = window.open(url,'wcshare', _getOptions());

                // handle popup blockers
                if (win === undefined) {
                    alert("Please allow popups and try again");
                }
            };

            var _requestPost = function(provider, data) {
                switch (provider) {
                    case "twitter":
                        _openTwitter(data);
                        break;
                    case "googleplus":
                        _openGooglePlus(data);
                        break;
                    case "linkedin":
                        _openLinkedin(data);
                        break;
                    case "pinterest":
                        _openPinterest(data);
                        break;
                    case "facebook":
                        _openFacebook(data);
                        break;
                    default:
                        console.log("Unknown provider \"" + provider + "\"");
                }
            };

            var _openTwitter = function(data) {
                var url = 'https://twitter.com/intent/tweet';
                url += '?url=' + encodeURIComponent(data.url);
                url += '&text=' + encodeURIComponent(data.text);
                url += '&hashtags=GetVideotized';
                url += '&via=webyclip';
                _openWindow(url);
            };

            var _openGooglePlus = function(data) {
                var url = 'https://plus.google.com/share';
                url += '?url=' + encodeURIComponent(data.url);
                _openWindow(url);
            };

            var _openLinkedin=function(data) {
                var url = 'https://www.linkedin.com/shareArticle';
                url += '?url=' + encodeURIComponent(data.url);
                url += '&mini=true';
                url += '&title=' + encodeURIComponent(data.title);
                url += '&summary=' + encodeURIComponent(data.summary);
                url += '&source=' + encodeURIComponent(data.source);
                _openWindow(url);
            };

            var _openPinterest = function(data){
                var url = 'https://pinterest.com/pin/create/button/';
                url += '?url=' + encodeURIComponent(data.url);
                url += '&media=' + encodeURIComponent(data.media);
                url += '&description=' + encodeURIComponent(data.description);
                _openWindow(url);
            };

            var _openFacebook = function(data){
                var url = 'https://www.facebook.com/dialog/feed';
                url += '?app_id=' + "508781382505999";
                url += '&display=' + "popup";
                url += '&redirect_uri=' + encodeURIComponent(location.protocol + "//" + location.hostname + "/FacebookRedirect.html");
                url += '&name=' + encodeURIComponent(data.name);
                url += '&caption=' + encodeURIComponent(data.caption);
                url += '&description=' + encodeURIComponent(data.description);
                url += '&link=' + encodeURIComponent(data.link);
                url += '&picture=' + encodeURIComponent(data.picture);
                url += '&source=' + encodeURIComponent(data.source);
                url += '&ref=' + "webyclip";
                _openWindow(url);
            };

            this.requestPost = _requestPost;
        };

        var shareWidget = new ShareWidget();

        var ReportWidget = function() {
            var _configureObject = function(data, url, embedded) {
                $.extend(true, _config, data);
                _url = url;
                _embedded = embedded;
                _setupUI();
            };

            var _setupUI = function() {
                var promise = $.Deferred();

                loadJavaScriptResourceByUrl("resources/webyclip.report.resources." + _config.resource + ".js", function() {
                    loadCssResourceByUrl("css/webyclip.report.style.default.css");
                    promise.resolve();
                });

                promise.then(function() {
                    _loadCustomCSS();
                    _drawOptions($("#options"), wcReportRes.structure, "reportOpt", 1, true);
                    _applyResourcesAndWireEvents();
                    _showRelevantFeatures();
                });
            };

            var _loadCustomCSS = function() {
                if (typeof _config.customStyle !== "undefined" && _config.customStyle !== null) {
                    loadCssResourceByUrl(_config.customStyle);
                }
            };

            var _applyResourcesAndWireEvents = function() {
                $(".report-close a.link-button").attr("title", wcReportRes.close).click(_closeHandler);
                $("#btn_submit").html(wcReportRes.send).click(_submitHandler);
                $("#btn_cancel").html(wcReportRes.cancel).click(_closeHandler);
                $("#tell_us_more").html(wcReportRes.tellUsMore);
                $("#comment-label").html(wcReportRes.commentLabel);
                $("#extraTextInput").find(".form-control").attr("placeholder", _config.extraTextInputPlaceholder).text(_config.extraTextInputDefaultValue);

                $("input[name*='report'][type='radio']").click(function(){
                    $("#options").removeClass("error");
                    var myLevel = parseInt($(this).attr("data-level"));
                    var $toHide = $("div[id*=_sub]").filter(function() {
                        return $(this).attr("data-level") > myLevel;
                    });
                    $toHide.hide().find("input[type=radio]:checked").removeAttr("checked");
                    var $subOptions = $("#" + $(this).attr("id") + "_suboptions");
                    if ($subOptions.size() > 0) {
                        // selects the first radio button
                        $("#" + $(this).attr("id") + "_1").attr("checked", "checked");
                        $subOptions.show();
                    }
                });
            };

            var _showOrHide = function(condToShow, selector) {
                if (condToShow) {
                    $(selector).show();
                }
                else {
                    $(selector).hide();
                }
            };

            var _showRelevantFeatures = function() {
                _showOrHide(_config.showRemoveText, ".login-to-remove");
                _showOrHide(_config.showCloseButton, ".report-close");
                _showOrHide(_config.showExtraTextInput, "#extraTextInput");
            };

            var _drawOptions = function($target, options, group, level) {
                $.each(options, function(idx, val) {
                    $("<input />")
                        .attr("type", "radio")
                        .attr("name", group)
                        .attr("id", val.id)
                        .attr("value", val.key)
                        .attr("data-level", level)
                        .attr("data-key", val.key)
                        .appendTo($target);
                    $("<label />")
                        .attr("for", val.id)
                        .html(val.title)
                        .attr("class", "opt-label")
                        .appendTo($target);
                    $("<br />").appendTo($target);

                    if (typeof val.control !== 'undefined' && val.control !== null && val.control === "text") {
                        $("<div />")
                            .attr("id",val.id + "_suboptions")
                            .attr("data-level",level + 1)
                            .hide().appendTo($target);
                        $("<textarea />")
                            .attr("id","txt_" + val.key)
                            .addClass("free-text")
                            .css("resize", "none")
                            .appendTo($("#" + val.id + "_suboptions"));
                    }

                    if (typeof val.options !== 'undefined' && val.options !== null) {
                        $("<div />")
                            .attr("id", val.id + "_suboptions")
                            .attr("class", "subOptions")
                            .attr("data-level", level + 1)
                            .hide().appendTo($target);

                        _drawOptions($("#" + val.id + "_suboptions"), val.options, "reportOpt" + (level + 1) , level + 1);
                    }
                    else  {
                        $("#" + val.id).attr("data-leaf-level",true);
                    }
                });
            };

            var _resetUI = function() {
                $("#report_validation").hide();
            };

            var _closeHandler = function() {
                _resetUI();
                _opened = false;
                $("#report_container").hide();
            };

            var _getStatus = function() {
                return _opened;
            }

            var _openHandler = function(media) {
                _currentPlayedItem = media;
                _opened = true;
                $("#report_container").show();
            };

            var _findByKey = function(array, key) {
                var i, subArray = [];
                for (i = 0; i < array.length; i++) {
                    if (typeof array[i].options !== "undefined" && array[i].options !== null) {
                        subArray.push(array[i].options);
                    }
                    if (array[i].key === key) {
                        return array[i];
                    }
                }
                for (i = 0; i < subArray.length; i++) {
                    return _findByKey(subArray[i], key);
                }
            };

            var _cleanErrors = function() {
                $("#options").removeClass("error");
                $("#extraTextInput").find(".form-control").removeClass("error");
                $("#comment").find(".form-control").removeClass("error");
            };

            var _submitHandler = function() {
                _cleanErrors();
                var $checked = $("input[name*='report'][type='radio'][data-leaf-level='true']:checked");
                if ($checked.size() > 0 )  {
                    var dataKey = $checked.attr("data-key"),
                        $extraText = $("#extraTextInput").find(".form-control"),
                        $comment = $("#comment").find(".form-control"),

                        repObj = _findByKey(wcReportRes.structure, dataKey),
                        extraText = $extraText.val().trim(),
                        comment = $comment.val().trim();

                    if (typeof repObj.options !== "undefined" && repObj.options !== null) {
                        $("#options").addClass("error");
                        return;
                    }

                    if (repObj.username && !extraText) {
                        $extraText.addClass("error");
                        return;
                    }

                    if (repObj.comment && !comment) {
                        $comment.addClass("error");
                        return;
                    }

                    postMessageToParent("reportSubmit", [_currentPlayedItem, dataKey, comment, _url, extraText]);

                    if (dataKey == "do_not_want_this_video") {
                        postMessageToParent("rejectMedias", []);
                    }

                    _closeHandler();
                }
                else {
                   $("#options").addClass("error");
                }
            };

            var _config = {};
            var _url = null;
            var _embedded = false;
            var _currentPlayedItem = null;
            var _opened = false;

            this.configureObject = _configureObject;
            this.openReport = _openHandler;
            this.close = _closeHandler;
            this.getStatus = _getStatus;
        };

        var reportWidget = new ReportWidget();

        var PlayerWidget = function() {
            var _messageListener = function(name, data) {
                switch (name) {
                    case "SET_CONFIG":
                        _configureObject(data);
                        break;
                    case "SET_DATA":
                        _setData(data);
                        break;
                    case "PLAY_VIDEO":
                        _playerIsReady.then(function() {
                            $(window).resize();
                            _playVideo(data);
                        });
                        break;
                    case "UPDATE_ITEM":
                        _updateItem(data);
                        break;
                    default:
                        console.log("Message listener error - unrecognized event \"" + name + "\"!");
                }
            };

            var _configureObject = function(data) {
                $.extend(true, _config, data);
                if (typeof data.autoPlay === "undefined" || data.autoPlay === null) {
                    _config.autoPlay = data.isEmbedded ? false : true;
                }
                reportWidget.configureObject(_config.reportButton, _config.url, _config.isEmbedded);
            };

            var _setData = function(data) {
                _destroyPlayers();
                _config.data = data || _config.data;
                _setupUI();
            };

            var _playVideo = function(data) {
                var mediaItemToPlay = null;
                var mediaItemIdx = -1;
                $.grep(_config.data, function(mediaItem, idx) {
                    if (mediaItem.webyclip_media_id === data.webyclip_media_id) {
                        mediaItemIdx = idx;
                        mediaItemToPlay = mediaItem;
                        return true;
                    }
                    return false;
                });
                _playMediaItem(mediaItemIdx);
            };

            var _updateItem = function(data) {
                var updatedItem = null;
                $.grep(_config.data, function(mediaItem) {
                    if (mediaItem.webyclip_media_id === data.media.webyclip_media_id) {
                        updatedItem = mediaItem;
                        return true;
                    }
                    return false;
                });
                if (updatedItem !== null) {
                    if (typeof data.social !== "undefined" && data.social !== null) {
                        updatedItem.social = data.social;
                        if (_currentPlayedItem !== null && updatedItem.webyclip_media_id === _currentPlayedItem.webyclip_media_id) {
                            _updateSocialMediaItemUI(updatedItem);
                        }
                    }
                }
            };

            var _destroyPlayers = function() {
                _playerIsReady = $.Deferred();

                $.each(_config.data, function(idx, mediaItem) {
                    if (typeof mediaItem.playerObj !== "undefined" && mediaItem.playerObj !== null) {
                        mediaItem.playerObj.destroyPlayerObj();
                    }
                });

                _currentPlayedItem = null;
            };

            var _setupUI = function() {
                var promiseCSS = $.Deferred();
                var promiseResources = $.Deferred();

                loadJavaScriptResourceByUrl("resources/webyclip.player.resources." + _config.resourceLang + ".js", function() {
                    _loadCustomResources();
                    promiseResources.resolve();
                });

                loadCssResourceByUrl("css/webyclip.player.style." + _config.mainStyle + ".css", function() {
                    if (typeof _config.customStyle !== "undefined" && _config.customStyle !== null) {
                        loadCssResourceByUrl(_config.customStyle, function() {
                            promiseCSS.resolve();
                        });
                    }
                    else {
                        promiseCSS.resolve();
                    }
                });

                $.when(promiseCSS, promiseResources).done(function() {
                    _updateForEmbedded();
                    _applyResourcesAndWireEvents();
                    _showRelevantComponents();
                    _createPlayers();
                    $(window).resize(function() {
                        _setCSS();
                    });
                    _setCSS();
                    postMessageToParent("INTERACTIVE");
                });
            };

            var _loadCustomResources = function() {
                for (var key in wc_res) {
                    if (wc_res.hasOwnProperty(key)) {
                        for (var sub_key in wc_res[key]) {
                            if (wc_res[key].hasOwnProperty(sub_key) && (typeof _config[key][sub_key] === "undefined" || _config[key][sub_key] === null)) {
                                _config[key][sub_key] = wc_res[key][sub_key];
                            }
                        }
                    }
                }
            };

            var _updateForEmbedded = function() {
                if (_config.isEmbedded) {
                    $(".mask, .mask .wc-container").addClass("embedded");
                }
                else {
                    $(".mask, .mask .wc-container").removeClass("embedded");
                }
            };

            var _applyResourcesAndWireEvents = function() {
                _applyResources();
                _applyEvents();
            };

            var _applyResources = function() {
                $(".disclaimer, .disclaimer-container").html(_config.disclaimer.text);
                $(".disclaimer-toggle .disclaimer-toggle-caption").html(_config.disclaimer.toggleText);
                $(".webyclip-credit .credit").html(_config.webyClipCredits.text);
                $(".social .social-caption").html(_config.social.text);
                $(".related-items-title .related-items-caption").html(_config.relatedItems.text);
                $(".more-videos-title .more-videos-caption").html(_config.moreVideos.text);
                $(".close-me .link-button").attr("title", _config.closeButton.attr);
                $(".like a.link-button").attr("title", _config.social.thumbUpAttr);
                $(".liked a.link-button").attr("title", _config.social.thumbUpAttrCancel);
                $(".dislike a.link-button").attr("title", _config.social.thumbsDownAttr);
                $(".disliked a.link-button").attr("title", _config.social.thumbsDownAttrCancel);
                $(".webyclip-report").attr("title", _config.reportButton.attr);
                $(".webyclip-credit .logo a.link-button").attr("href", "http://www.webyclip.com/").attr("target", "_blank");
            };

            var _applyEvents = function() {
                $(".mask, .close-me .link-button").click(_closeHandler);
                $(".share-button").click(_shareCollapseHandler);
                $(".facebook .link-button").click(_shareClickHandler("facebook"));
                $(".linkedin .link-button").click(_shareClickHandler("linkedin"));
                $(".pinterest .link-button").click(_shareClickHandler("pinterest"));
                $(".twitter .link-button").click(_shareClickHandler("twitter"));
                $(".googleplus .link-button").click(_shareClickHandler("googleplus"));
                $(".like a.link-button").click(_socialHandler("like"));
                $(".dislike a.link-button").click(_socialHandler("dislike"));
                $(".liked a.link-button, .disliked a.link-button").click(_socialHandler(""));
                $(".webyclip-report").click(_reportHandler);
                $(".related-items-title").click(function() {
                    _collapseHandler(".related-items");
                });
                $(".more-videos-title").click(function() {
                    _collapseHandler(".more-videos");
                });
                $(".related-items-hide-button").click(function() {
                    _relatedItemsCollapseHandler();
                });
                $(".disclaimer-toggle .disclaimer-toggle-caption").click(_disclaimerHandler);
                $(".page-corner a.link-button").click(function(event) {
                    _moreVideosClickHandler();
                    event.stopPropagation();
                    event.preventDefault();
                });
                $(".desktop-more-videos-container").click(function(event) {
                    _moreVideosClickHandler();
                    event.stopPropagation();
                    event.preventDefault();
                });
                $(".wc-container").click(function(event) {
                    event.stopPropagation();
                });
                $(".custom-icon .link-button").click(_customIconHandler);
            };

            var _showRelevantComponents = function() {
                // title component
                _setComponentVisibility(".media-title", _config.title.visibility);

                // Share component
                _setComponentVisibility(".media-share", _config.share.visibility);
                $.each(_config.share, function(key, value) {
                    if (value === Object(value) && !value.visibility) {
                        $("." + key).hide();
                    }
                });
                _setComponentVisibility(".social-networks-list", _config.share.initialCollapsing ? _componentStates.NEVER : _componentStates.EXTENDED);

                // title container
                if (!_isComponentVisible(_config.title.visibility, _componentStates.COMPACT) && !_isComponentVisible(_config.share.visibility, _componentStates.COMPACT)) {
                    $(".title-container").addClass("no-compact");
                }

                // webyclipCredits component
                _setComponentVisibility(".webyclip-credit", _config.webyClipCredits.visibility);

                // closeButton component
                _setComponentVisibility(".close-me", _config.isEmbedded ? _componentStates.NEVER : _config.closeButton.visibility);

                // social component
                _setComponentVisibility(".social", _config.social.visibility);

                // reportButton component
                _setComponentVisibility(".webyclip-report", _config.reportButton.visibility);

                // mobile social & reportButton
                if ((_config.social.visibility == "never" || _config.social.visibility == "extended") && (_config.reportButton.visibility == "never" || _config.reportButton.visibility == "extended")) {
                    $(".mobile-actions").hide();
                }

                // relatedItems component
                _setRelatedItemsVisibility();

                // disclaimer component
                _setComponentVisibility(".disclaimer", _config.disclaimer.visibility);
                _setComponentVisibility(".disclaimer-toggle", _config.disclaimer.mode == _disclaimerModes.TOGGLE || _config.disclaimer.mode == _disclaimerModes.POPUP ? _config.disclaimer.visibility : _componentStates.NEVER);
                if (_config.disclaimer.mode == _disclaimerModes.TOGGLE) {
                    _disclaimerHandler();
                }

                // moreVideos component
                _setMoreVideosVisibility();

                // customIcon component
                _setComponentVisibility(".custom-icon", _config.customIcon.visibility);
                var icon = new Image();
                icon.src = _config.customIcon.url;
                $(icon).one("load", function() {
                    $(".custom-icon .link-button")
                            .css("background", "url(" + _config.customIcon.url.replace(/'/g, "\\'") + ") no-repeat center center transparent")
                            .css("background-size", "contain")
                            .css("width", icon.width)
                            .css("height", icon.height);
                    $(".custom-icon").css("border-radius", "0px 0px " + icon.height / 2 + "px 0px");
                });
            };

            var _setRelatedItemsVisibility = function() {
                var $ri_container = $(".related-items-container");
                var $desktop_ri_container = $(".desktop-related-items-container");
                var $container = $(".wc-container");

                switch(_config.relatedItems.visibility) {
                    case _componentStates.NEVER:
                        $ri_container.addClass("visibility-never");
                        $desktop_ri_container.addClass("visibility-never");
                        $container.addClass("no-rel-itm");
                        break;
                    case _componentStates.COMPACT:
                        $ri_container.addClass("visibility-compact");
                        $desktop_ri_container.addClass("visibility-never");
                        $container.addClass("no-rel-itm");
                        break;
                    case _componentStates.EXTENDED:
                        $ri_container.addClass("visibility-never");
                        $desktop_ri_container.addClass("visibility-extended");
                        break;
                    case _componentStates.ALWAYS:
                        if (_config.relatedItems.vertical) {
                            $ri_container.addClass("visibility-always");
                            $desktop_ri_container.addClass("visibility-never");
                        } else {
                            $ri_container.addClass("visibility-compact");
                            $desktop_ri_container.addClass("visibility-extended");
                        }
                        break;
                    default:
                        console.log("Setting component error - unrecognized state \"" + state + "\"!");
                }
            };

            var _setMoreVideosVisibility = function() {
                var $more_videos_container = $(".more-videos-container");
                var $desktop_more_videos_container = $(".desktop-more-videos-container");
                var $page_corner = $(".page-corner");
                var $container = $(".wc-container");

                switch(_config.moreVideos.visibility) {
                    case _componentStates.NEVER:
                        $more_videos_container.addClass("visibility-never");
                        $desktop_more_videos_container.addClass("visibility-never");
                        $page_corner.addClass("visibility-never");
                        $container.addClass("no-rel-vid");
                        break;
                    case _componentStates.COMPACT:
                        $more_videos_container.addClass("visibility-compact");
                        $desktop_more_videos_container.addClass("visibility-never");
                        $page_corner.addClass("visibility-never");
                        break;
                    case _componentStates.EXTENDED:
                        $more_videos_container.addClass("visibility-never");
                        $desktop_more_videos_container.addClass("visibility-extended");
                        $page_corner.addClass(_config.data.length == 1 ? "visibility-never" : "visibility-extended");
                        $container.addClass("no-rel-vid");
                        break;
                    case _componentStates.ALWAYS:
                        $more_videos_container.addClass("visibility-compact");
                        $desktop_more_videos_container.addClass("visibility-extended");
                        $page_corner.addClass(_config.data.length == 1 ? "visibility-never" : "visibility-extended");
                        break;
                    default:
                        console.log("Setting component error - unrecognized state \"" + state + "\"!");
                }
            };

            var _resetComponent = function(component) {
                $(component)
                        .removeClass("visibility-never")
                        .removeClass("visibility-compact")
                        .removeClass("visibility-extended")
                        .removeClass("visibility-always");
            };

            var _setComponentVisibility = function(component, state) {
                _resetComponent(component);
                switch(state) {
                    case _componentStates.NEVER:
                        $(component).addClass("visibility-never");
                        break;
                    case _componentStates.COMPACT:
                        $(component).addClass("visibility-compact");
                        break;
                    case _componentStates.EXTENDED:
                        $(component).addClass("visibility-extended");
                        break;
                    case _componentStates.ALWAYS:
                        $(component).addClass("visibility-always");
                        break;
                    default:
                        console.log("Setting component error - unrecognized state \"" + state + "\"!");
                }
            };

            var _handleNavigation = function(carousel, left, right) {
                if (carousel.currentItem - 1 == 0) {
                    left.addClass("disabled");
                }
                else {
                    left.removeClass("disabled");
                }
                if (carousel.currentItem + 1 == carousel.itemsAmount - _config.relatedItems.itemsInCarousel) {
                    right.addClass("disabled");
                }
                else {
                    right.removeClass("disabled");
                }
            }

            var _createPlayers = function() {
                $.each(_config.data, function(idx, mediaItem) {
                    // Player
                    $("<div />")
                        .attr("id", "player-" + idx)
                        .attr("data-index", idx)
                        .attr("data-id", mediaItem.webyclip_media_id)
                        .attr("data-type", mediaItem.provider)
                        .data("wc-media", mediaItem)
                        .addClass("player")
                        .appendTo(".inner-media-player")
                        .hide();
                    mediaItem.playerObj = _createPlayerObj(mediaItem.webyclip_media_id, mediaItem.provider, mediaItem.external_id, "player-" + idx, "100%", "100%", _config.noCookies);

                    _createRelatedItems(mediaItem.related_items, idx);

                    _createMoreVideos(mediaItem, idx);
                });

                if (_config.data.length == 1 || !_config.moreVideos.visibility) {
                    $(".wc-container").addClass("no-rel-vid");
                }

                if (_config.data.length > 0) {
                    $("#player-0").show();
                    $("#thumbnail-0").hide();

                    var $relatedItems =  $(".related-items-list [id^=related-items-]");

                    $(".more-videos-list").owlCarousel({
                        items: 3.3,
                        pagination: false,
                        itemsDesktop: false,
                        itemsDesktopSmall: false,
                        itemsTablet: false,
                        itemsMobile: false
                    });

                    if (_config.moreVideos.initialCollapsing) {
                        _collapseHandler(".more-videos");
                    }

                    $relatedItems.owlCarousel({
                        items: _config.relatedItems.itemsInCarousel - 0.1,
                        loop: false,
                        pagination: false,
                        itemsDesktop: false,
                        itemsDesktopSmall: false,
                        itemsTablet: false,
                        itemsMobile: false
                    });

                    $(".carousel-arrows.push-left")
                            .click(function(event) {
                                event.preventDefault();
                                _handleNavigation($relatedItems.data("owlCarousel"), $(".carousel-arrows.push-left"), $(".carousel-arrows.push-right"));
                                $relatedItems.data("owlCarousel").prev();
                            })
                            .addClass("disabled");

                    $(".carousel-arrows.push-right").click(function(event) {
                        event.preventDefault();
                        _handleNavigation($relatedItems.data("owlCarousel"), $(".carousel-arrows.push-left"), $(".carousel-arrows.push-right"));
                        $relatedItems.data("owlCarousel").next();
                    });

                    $("*[id^='desktop-related-items-']").enscroll({
                        showOnHover: true,
                        addPaddingToPane: false,
                        verticalTrackClass: 'scroll-track',
                        verticalHandleClass: 'scroll-handle'
                    });

                    $(".desktop-more-videos-list").enscroll({
                        showOnHover: true,
                        addPaddingToPane: false,
                        verticalTrackClass: 'scroll-track',
                        verticalHandleClass: 'scroll-handle'
                    });

                    _config.data[0].playerObj.preloadPlayer();

                    _playerIsReady.resolve();
                }
            };

            var _createPlayerObj = function(id, type, videoId, domId, width, height,noCookies) {
                var result = null;
                switch (type) {
                    case "youtube":
                        var vars = {
                            showinfo: _config.title.duplicateOverPlayer ? 1: 0
                        };
                        result = new YouTubeClass(domId);
                        result.createPlayerObj(videoId, width, height, vars, {
                            onReady: function() {
                                setInterval(function() {
                                    if (result.getPlayerState() === YouTubeClass.PlayerState.PLAYING) {
                                        $(".media-player").removeClass("videos-list");
                                    }
                                }, 500);
                            },
                            stateChange: function(state) {
                                switch(state) {
                                    case YouTubeClass.PlayerState.PLAYING:
                                        _playingBefore = true;
                                        if (!_startPlayReported) {
                                            _startPlayReported = true;
                                            postMessageToParent("playStart", [_currentPlayedItem]);
                                        }
                                        break;
                                    case YouTubeClass.PlayerState.ENDED:
                                        _showMoreVideos();
                                        break;
                                    case YouTubeClass.PlayerState.PAUSED:
                                        _YTPauseHandler();
                                        break;
                                }
                            },
                            reportPlayedVideo: function(duration) {
                                postMessageToParent("playEnd", [_currentPlayedItem, duration]);
                            },
                            error: function() {
                                postMessageToParent("playbackError", [_currentPlayedItem]);
                            }
                        }, noCookies );
                        break;
                }
                return result;
            };

            var _createRelatedItems = function(related_items_array, idx) {
                if (_config.relatedItems.customScript || _config.relatedItems.customHtmlContent) {
                    if (_config.relatedItems.customHtmlContent) {
                        $(".right .custom-related-items").html(_config.relatedItems.customHtmlContent.desktop)
                        $(".left .custom-related-items").html(_config.relatedItems.customHtmlContent.mobile)
                    }
                    if (_config.relatedItems.customScript) {
                        loadJavaScriptResourceByUrl(_config.relatedItems.customScript, function() {});
                    }

                    $(".custom-related-items").show();
                    $(".default-related-items").hide();
                    $(".wc-container").removeClass("no-rel-itm");
                }
                else if (typeof related_items_array !== "undefined" && related_items_array !== null) {
                    if (typeof related_items_array.items !== "undefined" && related_items_array.items !== null && related_items_array.items.length) {
                        var same_time_RI = true;
                        var related_items = related_items_array.items;

                        // Stable sort for RI
                        related_items.sort(function (relatedItem1, relatedItem2) {
                            if (relatedItem1.from_second === relatedItem2.from_second) {
                                return related_items.indexOf(relatedItem1) - related_items.indexOf(relatedItem2);
                            }
                            else {
                                same_time_RI = false;
                                return relatedItem1.from_second - relatedItem2.from_second;
                            }
                        });

                        // Compact
                        $("<div />")
                            .attr("id", "related-items-" + idx)
                            .appendTo(".related-items-list");
                        $.each(related_items, function (ri_idx, related_item) {
                            var ri = $("<div />")
                                .attr("id", "related-item-" + idx + "-" + ri_idx);
                            $("<a />")
                                .attr("id", "related-item-img-" + idx + "-" + ri_idx)
                                .attr("href", _fixURI(related_item.link_data))
                                .attr("target", _config.relatedItems.openInNewTab ? "_blank" : "_top")
                                .click(_relatedItemClickHandler(ri_idx))
                                .css("background", "url(" + _fixImgURI(related_item.image_url) + ") no-repeat center center transparent")
                                .css("background-size", "contain")
                                .appendTo(ri);
                            $("<span />")
                                .attr("id", "related-item-title-" + idx + "-" + ri_idx)
                                .html(related_item.title)
                                .appendTo(ri);
                            if (same_time_RI || _config.relatedItems.addingOrder == _relatedItemsOrders.FIRST) {
                                $("#related-items-" + idx).prepend(ri);
                            }
                            else {
                                $("#related-items-" + idx).append(ri);
                            }
                        });

                        // Extended
                        $("<div />")
                            .attr("id", "desktop-related-items-" + idx)
                            .appendTo(".desktop-related-items-list")
                            .hide();
                        $.each(related_items, function (ri_idx, related_item) {
                            var desktop_ri = $("<div />")
                                .attr("id", "desktop-ri-" + idx + "-" + ri_idx);

                            if (related_item.from_second !== 0) {
                                desktop_ri.hide();
                            }

                            $("<a />")
                                .addClass("desktop-related-item-img")
                                .attr("href", _fixURI(related_item.link_data))
                                .attr("target", _config.relatedItems.openInNewTab ? "_blank" : "_top")
                                .click(_relatedItemClickHandler(ri_idx))
                                .css("background", "url(" + _fixImgURI(related_item.image_url) + ") no-repeat center center transparent")
                                .css("background-size", "contain")
                                .appendTo(desktop_ri);
                            var ri_info = $("<div />")
                                .addClass("related-item-info")
                                .appendTo(desktop_ri);
                            $("<div />")
                                .addClass("ri-title")
                                .attr("title", related_item.title)
                                .attr("target", _config.relatedItems.openInNewTab ? "_blank" : "_top")
                                .html(related_item.title)
                                .dotdotdot({
                                    ellipsis: "...",
                                    wrap: "letter",
                                    watch: true
                                })
                                .click(function() {
                                    _relatedItemClickHandler(ri_idx)();
                                    window.open(_fixURI(related_item.link_data), _config.relatedItems.openInNewTab ? "_blank" : "_top");
                                })
                                .appendTo(ri_info);
                            $("<div />")
                                .addClass("ri-description")
                                .attr("title", related_item.description)
                                .html(related_item.description)
                                .appendTo(ri_info);
                            $("<a />")
                                .addClass("ri-action")
                                .html(_config.relatedItems.actionText)
                                .attr("href", _fixURI(related_item.link_data))
                                .attr("target", _config.relatedItems.openInNewTab ? "_blank" : "_top")
                                .click(_relatedItemClickHandler(ri_idx))
                                .appendTo(ri_info);
                            if (same_time_RI || _config.relatedItems.addingOrder == _relatedItemsOrders.FIRST) {
                                $("#desktop-related-items-" + idx).prepend(desktop_ri);
                            }
                            else {
                                $("#desktop-related-items-" + idx).append(desktop_ri);
                            }
                        });

                        if (related_items[0].from_second == 0) {
                            _relatedItemsCollapseHandler(false);
                        }
                    }
                }
            };

            var _createMoreVideos = function(mediaItem, idx) {
                if (_config.data.length > 1 && _config.moreVideos.visibility) {
                    // Compact
                    $("<div />")
                        .attr("id", "thumbnail-" + idx)
                        .click(function() {
                            _nextMediaHandler(idx);
                        })
                        .appendTo(".more-videos-list");
                    $("<a />")
                        .attr("id", "thumbnail-img-" + idx)
                        .attr("href", "javascript:void(0);")
                        .css("background", "url(https://img.youtube.com/vi/" + mediaItem.external_id + "/hqdefault.jpg) no-repeat left center transparent")
                        .css("background-size", "cover")
                        .appendTo("#thumbnail-" + idx);
                    $("<span />")
                        .attr("id", "thumbnail-time-" + idx)
                        .html(_getTime(mediaItem.base_media.duration))
                        .appendTo("#thumbnail-" + idx);

                    // Extended
                    $("<div />")
                        .attr("id", "desktop-thumbnail-" + idx)
                        .click(function() {
                            _nextMediaHandler(idx)
                        })
                        .appendTo(".desktop-more-videos-list");
                    $("<a />")
                        .attr("id", "desktop-thumbnail-img-" + idx)
                        .attr("href", "javascript:void(0);")
                        .css("background", "url(https://img.youtube.com/vi/" + mediaItem.external_id + "/hqdefault.jpg) no-repeat left center transparent")
                        .css("background-size", "cover")
                        .appendTo("#desktop-thumbnail-" + idx);
                    $("<span />")
                        .attr("id", "desktop-thumbnail-time-" + idx)
                        .html(_getTime(mediaItem.base_media.duration))
                        .appendTo("#desktop-thumbnail-img-" + idx);
                    $("<div />")
                        .attr("id", "desktop-play-mask-" + idx)
                        .appendTo("#desktop-thumbnail-img-" + idx)
                        .click(function(event) {
                            _moreVideosClickHandler();
                            event.stopPropagation();
                            event.preventDefault();
                        });
                }
            };

            var _setCSS = function() {
                var height;
                if (!_config.isEmbedded) {
                    var $container = $(".wc-container");
                    var screenHeight = $(".mask").height();
                    height = $container.height();

                    if (height < screenHeight) {
                        $container.css("margin-top", -(height / 2) + 5);
                    }
                    else {
                        $container.css("margin-top", -(screenHeight / 2) + 10);
                    }
                }
                else {
                    var $title = $(".title-container");
                    var $actions = $(".mobile-actions");
                    var $ri = $(".related-items-container");
                    var $mv = $(".more-videos-container");
                    height = $title.height() +
                            ($actions.css("display") != "none" ? $actions.height() : 0) +
                            ($ri.css("display") != "none" ? $ri.outerHeight() : 0) +
                            ($mv.css("display") != "none" ? $mv.outerHeight() : 0) +
                            ($(".media-player").height());

                    $(".media-area").height(height);
                }
            };

            // region PLAYER EVENT

            var _playMediaItem = function(mediaItemIdx) {
                var mediaItemToPlay = _config.data[mediaItemIdx];
                if (mediaItemToPlay) {
                    _playingBefore = false;
                    $(".media-title").attr("title", mediaItemToPlay.context_title).html(mediaItemToPlay.context_title);
                    _stopPlayedVideo();
                    _updateRelatedItemsUI(mediaItemToPlay, mediaItemIdx);
                    mediaItemToPlay.playerObj.play(_config.autoPlay);
                    _updateUIForPlayedMedia(mediaItemIdx);
                    _updateSocialMediaItemUI(mediaItemToPlay);
                    _updateThumbnailGallery(mediaItemIdx);
                    _currentPlayedItem = mediaItemToPlay;
                    _currentPlayedItemIndex = mediaItemIdx;
                    _hideMoreVideos();
                    _setCSS();
                }
            };

            var _stopPlayedVideo = function() {
                if (_currentPlayedItem) {
                    var state = _currentPlayedItem.playerObj.getPlayerState();
                    if (state !== null && (state === YouTubeClass.PlayerState.PLAYING || state === YouTubeClass.PlayerState.BUFFERING)) {
                        _currentPlayedItem.playerObj.stop();
                    }
                }
            };

            var _continuePlayVideo = function() {
                if (_currentPlayedItem) {
                    _currentPlayedItem.playerObj.continuePlay();
                }
            };

            // endregion

            // region UI FUNCTIONS

            var _updateRelatedItemsUI = function(mediaItem, mediaIndex) {
                if (_config.relatedItems.customScript || _config.relatedItems.customHtmlContent) {
                    // if this is a custom related do nothing...
                }
                else if (_isComponentVisible(_config.relatedItems.visibility) && typeof  mediaItem.related_items !== "undefined" && mediaItem.related_items !== null && mediaItem.related_items.items.length) {
                    $("[id^=related-items-]").hide();
                    $('#related-items-' + mediaIndex).show();

                    $("[id^=desktop-related-items]").hide();
                    $('#desktop-related-items-' + mediaIndex).show();

                    if (_isComponentVisible(_config.relatedItems.visibility, _componentStates.EXTENDED) && _config.relatedItems.hideButton) {
                        _setComponentVisibility(".related-items-hide-button", _componentStates.EXTENDED);
                    }

                    var animation = setInterval(function() {
                        $.each(mediaItem.related_items.items, function (idx, item) {
                            if (_isComponentVisible(_config.relatedItems.visibility, _componentStates.EXTENDED) && item.from_second !== "undefined" && item.from_second !== null && mediaItem.playerObj.getCurrentTime() >= item.from_second ) {
                                _relatedItemsCollapseHandler(false);
                                _setCSS();
                                clearInterval(animation);
                            }
                        });
                    }, 500);

                    setInterval(function() {

                        if (_isYTPaused()) return;

                        $.each(mediaItem.related_items.items, function (idx, item) {
                            var currentTime = mediaItem.playerObj.getCurrentTime();

                            if (typeof(item.from_second) !== "undefined" && item.from_second !== null && currentTime >= item.from_second) {
                                $("#desktop-ri-" + mediaIndex + "-" + idx).show("slow");
                                $("#related-item-" + mediaIndex + "-" + idx).show("slow");

                                if (_firstTimeRI) {
                                    if ($(".related-items-collapse-icon").hasClass("collapsed")) {
                                        _collapseHandler(".related-items");
                                    }
                                    _firstTimeRI = false;
                                }
                            }

                            if (_config.relatedItems.highlighting) {
                                if (item.highlight_info) {
                                    if (currentTime >= (item.highlight_info.from || item.from_second) + (item.highlight_info.from_offset || 0) && currentTime <= (item.highlight_info.to || item.from_second) + (item.highlight_info.to_offset || 0)) {
                                        if (!item.highlight_info.hi_rect) {
                                            _highlightItem(item.highlight_info);
                                        }
                                       }
                                    else {
                                        if (currentTime > (item.highlight_info.to || item.from_second) + (item.highlight_info.to_offset || 0)) {
                                            if (item.highlight_info.hi_rect) {
                                                _clearItem(item.highlight_info.hi_rect);
                                                item.highlight_info.hi_rect = null;
                                            }
                                        }
                                    }
                                }
                            }
                        });
                    }, 500);
                }
                else {
                    _setComponentVisibility(".related-items-hide-button", _componentStates.NEVER);
                    _relatedItemsCollapseHandler(true);
                    _setCSS();
                }
            };

            var _updateUIForPlayedMedia = function(mediaIndex) {
                $(".player").hide();
                $("#player-" + mediaIndex).show();
            };

            var _updateSocialMediaItemUI = function(mediaItem) {
                _removeAllSocialStyling();
                var social = $(".social");
                switch (mediaItem.social) {
                    case "like":
                        social.addClass("likedOn");
                        social.addClass("dislikeOn");
                        break;
                    case "dislike":
                        social.addClass("dislikedOn");
                        social.addClass("likeOn");
                        break;
                    default:
                        social.addClass("likeOn");
                        social.addClass("dislikeOn");
                        break;
                }
            };

            var _removeAllSocialStyling = function() {
                var social = $(".social");

                social.removeClass("likedOn");
                social.removeClass("dislikedOn");
                social.removeClass("likeOn");
                social.removeClass("dislikeOn");
            };

            var _updateThumbnailGallery = function(mediaIndex) {
                $("[id^=thumbnail-]").show();
                $("[id^=desktop-thumbnail-img-]").removeClass("active");
                $("[id^=desktop-play-mask-]").hide();
                $('#thumbnail-' + mediaIndex).hide();
                $('#desktop-thumbnail-img-' + mediaIndex).addClass("active");
                $('#desktop-play-mask-' + mediaIndex).show();
            };

            var _showMoreVideos = function() {
                if (_config.data.length > 1 && _isComponentVisible(_config.moreVideos.visibility, _componentStates.EXTENDED)) {
                    $(".media-player").addClass("videos-list");
                }
            };

            var _hideMoreVideos = function() {
                if (_config.data.length > 1 && _isComponentVisible(_config.moreVideos.visibility, _componentStates.EXTENDED)) {
                    $(".media-player").removeClass("videos-list");
                    _continuePlayVideo();
                }
            };

            var _highlightItem = function (item) {

                if (!document.getElementById("ri_canvas")) {
                    _initHighlightItems();
                }

                item.hi_rect = _drawRect(document.getElementById("ri_canvas"),item,'white', 3);
            };

            var _initHighlightItems = function () {
                var svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                svg.setAttributeNS(null,"id", "ri_canvas");
                svg.setAttributeNS(null,"style","z-index:50000; width:100%; height: 100%;position: absolute;top: 0; pointer-events:none;");

                var parent = document.getElementById("ar_container");
                parent.insertBefore(svg,parent.firstChild);
            };

            var _drawRect = function(canvas,item,stroke,strokeWidth) {
                var x = (''+(100*item.left/16)+'%');
                var y = (''+(100*item.top/9)+'%');
                var width = (''+(100*item.width/16)+'%');
                var height = (''+(100*item.height/9)+'%');

                var svgns = "http://www.w3.org/2000/svg";
                var rect = document.createElementNS(svgns, 'rect');
                rect.setAttributeNS(null,"x",x);
                rect.setAttributeNS(null,"y",y);
                rect.setAttributeNS(null,"width",width);
                rect.setAttributeNS(null,"height",height);
                rect.setAttributeNS(null,"style",'stroke:' + stroke + '; stroke-width:' + strokeWidth + '; fill:none;');

                document.getElementById("ri_canvas").appendChild(rect);
                return rect;
            };

            var _clearItem = function(item) {
                document.getElementById("ri_canvas").removeChild(item);
            };

            // endregion

            // region UTILS

            var _getTime = function(seconds) {
                var hours = Math.floor(seconds / 3600);
                seconds -= hours * 3600;
                var minutes = Math.floor(seconds / 60);
                seconds -= minutes * 60;

                return (hours == 0 ? "" : hours + ":") + (minutes < 10 ? '0' + minutes : minutes) + ":" + (seconds < 10 ? '0' + seconds : seconds);
            };

            var _fixURI = function(string) {
                return typeof(string) !== "undefined" && string !== null ?
                        string.replace(/&amp;/g, "&")
                            .replace(/&amp;/g, "&")
                            .replace(/&quot;/g, '"')
                            .replace(/&lt;/g, "<")
                            .replace(/&gt;/g, ">") : null;
            };

            var _fixImgURI = function(string) {
               return typeof(string) !== "undefined" && string !== null ?
                       string.replace(/'/g, "\\'")
                           .replace(/\(/g, "\\(")
                           .replace(/\)/g, "\\)") : null;
            };

            var _isComponentVisible = function(visibility, layout) {
                switch(layout) {
                    case _componentStates.COMPACT:
                        return !!(visibility == _componentStates.COMPACT || visibility == _componentStates.ALWAYS);
                        break;
                    case _componentStates.EXTENDED:
                        return !!(visibility == _componentStates.EXTENDED || visibility == _componentStates.ALWAYS);
                        break;
                    default:
                        return visibility != _componentStates.NEVER;
                        break;
                }
            };

            var _isYTPaused = function() {
                return _currentPlayedItem.playerObj.getPlayerState() !== YouTubeClass.PlayerState.PLAYING
                        && _currentPlayedItem.playerObj.getPlayerState() !== YouTubeClass.PlayerState.BUFFERING
            };

            // endregion

            // region EVENTS & HANDLERS

            var _YTPauseHandler = function() {
                setTimeout(function() {
                    if ( _currentPlayedItem.playerObj.getPlayerState() !== YouTubeClass.PlayerState.PLAYING && _currentPlayedItem.playerObj.getPlayerState() !== YouTubeClass.PlayerState.BUFFERING) {
                        _showMoreVideos();
                    }
                }, 300);
            };

            var _closeHandler = function() {
                _stopPlayedVideo();
                reportWidget.close();
                _currentPlayedItemIndex = -1;
                _startPlayReported = false;
                postMessageToParent("CLOSE");
            };

            var _shareCollapseHandler = function() {
                $(".social-networks-list").animate({
                    width: "toggle"
                }, 350);
            };

            var _shareClickHandler = function(provider) {
                return function() {
                    _stopPlayedVideo();
                    var data = $.extend({}, _config.share[provider]);
                    for (var key in data) {
                        if (data.hasOwnProperty(key)) {
                            if (data[key] !== null && data[key].replace) {
                                data[key] = data[key].replace("[key]", _currentPlayedItem.external_id);
                                data[key] = data[key].replace("[title]", _currentPlayedItem.context_title);
                                data[key] = data[key].replace("[url]", _addMediaLinktoURL(_config.url));
                                data[key] = data[key].replace("[domain]", _config.domain);
                            }
                        }
                    }
                    shareWidget.requestPost(provider, data);
                    postMessageToParent("socialShare", [_currentPlayedItem, provider]);
                }
            };

            var _addMediaLinktoURL = function(url) {
                var returnedUrl = url;

                if (typeof _config.share !== "undefined" && _config.share !== null &&
                        typeof _config.share.uniqueShareId !== "undefined") {
                    returnedUrl = _updateQueryStringParameter(url, "wc_pid", encodeURIComponent(_config.share.uniqueShareId));
                    returnedUrl = _updateQueryStringParameter(returnedUrl, "wc_mid", encodeURIComponent(_currentPlayedItem.webyclip_media_id));
                }

                return returnedUrl;
            };

            var _updateQueryStringParameter = function(uri, key, value) {
                var re = new RegExp("([?|&])" + key + "=.*?(&|#|$)", "i");
                if (uri.match(re)) {
                    return uri.replace(re, '$1' + key + "=" + value + '$2');
                } else {
                    var hash =  '';
                    if( uri.indexOf('#') !== -1 ){
                        hash = uri.replace(/.*#/, '#');
                        uri = uri.replace(/#.*/, '');
                    }
                    var separator = uri.indexOf('?') !== -1 ? "&" : "?";
                    return uri + separator + key + "=" + value + hash;
                }
            };

            var _relatedItemClickHandler = function(index) {
                return function() {
                    _stopPlayedVideo();
                    postMessageToParent("relatedItemClick", [_currentPlayedItem, _currentPlayedItem.related_items.items[index]]);
                }
            };

            var _moreVideosClickHandler = function() {
                if ($(".media-player").hasClass("videos-list")) {
                    _hideMoreVideos();
                }
                else {
                    if (_playingBefore) {
                        _stopPlayedVideo();
                    }
                    else {
                        _YTPauseHandler();
                    }
                }
            };

            var _socialHandler = function(message) {
                return function() {
                    postMessageToParent("likeChange", [_currentPlayedItem, message]);
                }
            };

            var _reportHandler = function() {
                // TODO temporarily for embedded
                if (reportWidget.getStatus() && !_config.isEmbedded) {
                    if (_currentPlayedItem.playerObj.getPlayerState() !== YouTubeClass.PlayerState.PAUSED) {
                        _continuePlayVideo();
                    }
                    reportWidget.close();
                } else {
                    if (_config.reportButton.stopPlayingVideo) {
                        _stopPlayedVideo();
                    }
                    $(".disclaimer-container").hide();
                    reportWidget.openReport(_currentPlayedItem);
                }

            };

            var _nextMediaHandler = function(index) {
                _playMediaItem(index);
                postMessageToParent("playStart", [_currentPlayedItem]);
            };

            var _collapseHandler = function(target_div) {
                var list_div = $(target_div + "-list");
                var collapse_icon = $(target_div + "-collapse-icon");
                var main_container = $(".wc-container");

                if (collapse_icon.hasClass("collapsed")) {
                    collapse_icon.removeClass("collapsed");
                    list_div.show();
                    if (target_div == ".more-videos") {
                        main_container.removeClass("rel-vid-collapsed")
                    }
                    else {
                        main_container.removeClass("rel-itm-collapsed")
                    }
                }
                else {
                    collapse_icon.addClass("collapsed");
                    list_div.hide();
                    if (target_div == ".more-videos") {
                        main_container.addClass("rel-vid-collapsed")
                    }
                    else {
                        main_container.addClass("rel-itm-collapsed")
                    }
                }
                _setCSS();
            };

            var _relatedItemsCollapseHandler = function(add_flag) {
                var container = $(".wc-container");
                var button_container = $(".related-items-hide-button");
                switch(add_flag) {
                    case true:
                        container.addClass("no-rel-itm");
                        button_container.addClass("bt-left").removeClass("bt-right");
                        break;
                    case false:
                        container.removeClass("no-rel-itm");
                        button_container.addClass("bt-right").removeClass("bt-left");
                        break;
                    default:
                        if (container.hasClass("no-rel-itm")) {
                            container.removeClass("no-rel-itm");
                            button_container.addClass("bt-right").removeClass("bt-left");
                        }
                        else {
                            container.addClass("no-rel-itm");
                            button_container.addClass("bt-left").removeClass("bt-right");
                        }
                        break;
                }
                _setCSS();
            };

            var _disclaimerHandler = function() {
                var $disclaimer = $(".disclaimer");
                if (_config.disclaimer.mode === _disclaimerModes.TOGGLE) {
                    $disclaimer.css("visibility", ($disclaimer.css("visibility") == "hidden") ? "visible" : "hidden");
                }
                else if (_config.disclaimer.mode === _disclaimerModes.POPUP) {
                    $disclaimer.hide();
                    var $disclaimerContainer = $(".disclaimer-container");
                    if($disclaimerContainer.css("display") !== "none") {
                        $disclaimerContainer.hide();
                    }
                    else {
                        $disclaimerContainer.show();
                        reportWidget.close();
                    }
                }
            };

            var _customIconHandler = function() {
                postMessageToParent("iconClick", [_currentPlayedItem]);
            };

            // endregion

            // region CONFIGURATION

            var _componentStates = {
                NEVER: "never",
                COMPACT: "compact",
                EXTENDED: "extended",
                ALWAYS: "always"
            };
            var _relatedItemsOrders = {
                FIRST: "first",
                LAST: "last"
            };
            var _disclaimerModes = {
                PLAINTEXT: "plaintext",
                TOGGLE: "toggle",
                POPUP: "popup"
            };
            var _languages = {
                ENGLISH: "en",
                HEBREW: "he",
                GERMAN: "de"
            };

            var _config = {
                data: [],
                resourceLang: _languages.ENGLISH,
                mainStyle: "default",
                customStyle: null,
                noCookies: false,
                title: {
                    visibility: _componentStates.ALWAYS,
                    duplicateOverPlayer: false
                },
                webyClipCredits: {
                    visibility: _componentStates.ALWAYS
                },
                closeButton: {
                    visibility: _componentStates.ALWAYS
                },
                social: {
                    visibility: _componentStates.ALWAYS
                },
                reportButton: {
                    visibility: _componentStates.NEVER,
                    resource: _languages.ENGLISH,
                    customStyle: null,
                    stopPlayingVideo: true,
                    showCloseButton: false,
                    showRemoveText: false,
                    showExtraTextInput: false,
                    extraTextInputPlaceholder: "",
                    extraTextInputDefaultValue: ""
                },
                share: {
                    visibility: _componentStates.ALWAYS,
                    initialCollapsing: true,
                    facebook: {
                        visibility: true,
                        name: "[title]",
                        caption: "Watch the video on [domain]",
                        description: "A great video I saw while shopping at [domain]. Visit: [url]",
                        link: "[url]",
                        picture: "https://app.webyclip.com/api.php?action=sharable_content_get_video_thumbnail&vid=[key]",
                        source: "https://www.youtube.com/v/[key]?autohide=1&amp;version=3"
                    },
                    googleplus: {
                        visibility: true,
                        url: "[url]"
                    },
                    linkedin: {
                        visibility: true,
                        url: "[url]",
                        title: "Watch the video on [domain]",
                        summary: "A great video I saw while shopping at [domain]",
                        source: "https://app.webyclip.com/api.php?action=sharable_content_get_video_thumbnail&vid=[key]"
                    },
                    twitter: {
                        visibility: true,
                        url: "[url]",
                        text: "A great video I saw while shopping at [domain]"
                    },
                    whatsapp: {
                        visibility: false
                    },
                    pinterest: {
                        visibility: true,
                        url: "[url]",
                        description: "A great video I saw while shopping at [domain]",
                        media: "https://app.webyclip.com/api.php?action=sharable_content_get_video_thumbnail&vid=[key]"
                    }
                },
                moreVideos: {
                    visibility: _componentStates.ALWAYS,
                    initialCollapsing: false
                },
                relatedItems: {
                    visibility: _componentStates.ALWAYS,
                    initialCollapsing: false,
                    hideButton: false,
                    addingOrder: _relatedItemsOrders.FIRST,
                    highlighting: false,
                    openInNewTab: false,
                    customScript: null,
                    customHtmlContent: null,
                    itemsInCarousel: 3.3,
                    vertical: false
                },
                disclaimer: {
                    visibility: _componentStates.ALWAYS,
                    mode: _disclaimerModes.PLAINTEXT
                },
                customIcon: {
                    visibility: _componentStates.NEVER,
                    url: ""
                }
            };

            var _startPlayReported = false;
            var _currentPlayedItem = null;
            var _currentPlayedItemIndex = -1;
            var _playingBefore = false;
            var _firstTimeRI = true;
            var _playerIsReady = $.Deferred();

            // endregion

            registerMessageListener(_messageListener);
            postMessageToParent(":READY", {});
        };

        YouTubeClass.IframeAPIReadyPromise.then(function() {
            new PlayerWidget();
        });
    })(jQuery);
    </script>








</body></html>